<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Offres de stage</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1220;
      --card: rgba(17, 25, 40, 0.72);
      --card2: rgba(17, 25, 40, 0.58);
      --border: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.62);
      --muted2: rgba(255,255,255,0.72);
      --primary1:#3B82F6;
      --primary2:#8B5CF6;
      --good:#22C55E;
      --warn:#F59E0B;
    }

    /* ===== Dark Premium Background (no white) ===== */
    body{
      min-height: 100vh;
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(59,130,246,0.22), transparent 55%),
        radial-gradient(900px 500px at 85% 15%, rgba(139,92,246,0.20), transparent 60%),
        radial-gradient(900px 600px at 30% 90%, rgba(34,197,94,0.14), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      background-attachment: fixed;
      overflow-x: hidden;
    }

    /* subtle moving grain */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .16;
      mix-blend-mode: overlay;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.22'/%3E%3C/svg%3E");
      animation: grain 11s linear infinite;
    }
    @keyframes grain{
      0%{ transform: translate3d(0,0,0); }
      50%{ transform: translate3d(-2%, 1%, 0); }
      100%{ transform: translate3d(0,0,0); }
    }

    /* ===== Hero ===== */
    .hero{
      border-radius: 22px;
      background: linear-gradient(135deg, rgba(17,25,40,0.72), rgba(17,25,40,0.52));
      border: 1px solid var(--border);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 55px rgba(0,0,0,.35);
      position: relative;
      overflow: hidden;
      padding: 26px 22px;
    }
    .hero::after{
      content:"";
      position:absolute;
      inset:-120px -160px auto auto;
      width: 320px; height: 320px;
      background: radial-gradient(circle at 30% 30%, rgba(59,130,246,.35), transparent 60%);
      filter: blur(0px);
      transform: rotate(10deg);
      opacity: .95;
    }
    .hero h1{
      letter-spacing: .2px;
    }
    .hero p{
      color: var(--muted);
      max-width: 760px;
      margin: 0 auto;
    }
    .hero-note{
      margin-top: 12px;
      display: inline-flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .note-pill{
      display: inline-flex;
      align-items: center;
      gap: .55rem;
      padding: .45rem .75rem;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      color: rgba(255,255,255,0.78);
      font-weight: 600;
      font-size: .86rem;
    }

    /* ===== Card ===== */
    .card{
      border: 1px solid var(--border);
      border-radius: 18px;
      background: linear-gradient(180deg, var(--card), var(--card2));
      backdrop-filter: blur(10px);
      box-shadow: 0 14px 38px rgba(0,0,0,0.32);
      transition: transform .22s ease, box-shadow .22s ease, border-color .22s ease;
      overflow: hidden;
      position: relative;
      transform-style: preserve-3d;
      will-change: transform;
    }
    .card::before{
      content:"";
      position:absolute;
      top:0; left:0; right:0;
      height: 3px;
      background: linear-gradient(90deg,
        rgba(59,130,246,.0),
        rgba(59,130,246,.65),
        rgba(139,92,246,.60),
        rgba(34,197,94,.50),
        rgba(59,130,246,.0)
      );
      opacity: .95;
    }
    .card:hover{
      transform: translateY(-8px);
      box-shadow: 0 22px 56px rgba(0,0,0,0.45);
      border-color: rgba(255,255,255,0.16);
    }

    .card-title{
      color: var(--text);
      line-height: 1.25;
    }
    .subtle{
      color: var(--muted);
    }

    /* ===== Info blocks for fast reading ===== */
    .info-grid{
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .info-row{
      display:flex;
      align-items:flex-start;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
    }
    .info-ico{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(59,130,246,0.14);
      border: 1px solid rgba(59,130,246,0.20);
      color: rgba(255,255,255,0.92);
      flex: 0 0 auto;
    }
    .info-k{
      font-weight: 700;
      font-size: .88rem;
      color: rgba(255,255,255,0.86);
      margin-bottom: 2px;
      letter-spacing: .2px;
    }
    .info-v{
      color: rgba(255,255,255,0.70);
      font-size: .92rem;
      line-height: 1.25;
    }

    /* ===== Badges ===== */
    .badge-sector{
      border-radius: 999px;
      padding: .45rem .75rem;
      font-weight: 700;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.12);
      color: rgba(255,255,255,0.86);
    }
    .badge-period{
      border-radius: 999px;
      padding: .40rem .70rem;
      font-weight: 700;
      background: rgba(34,197,94,0.14);
      border: 1px solid rgba(34,197,94,0.22);
      color: rgba(209,255,225,0.92);
    }

    /* ===== Button ===== */
    .btn-primary{
      border: none;
      border-radius: 14px;
      padding: .78rem .95rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary1), var(--primary2));
      box-shadow: 0 12px 26px rgba(59,130,246,0.25);
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    .btn-primary:hover{
      transform: translateY(-2px);
      filter: brightness(1.05);
      box-shadow: 0 16px 34px rgba(59,130,246,0.34);
    }

    /* ===== Reveal on scroll ===== */
    .reveal{
      opacity: 0;
      transform: translateY(18px) scale(0.985);
      transition: opacity .7s ease, transform .7s cubic-bezier(.2,.65,.2,1);
    }
    .reveal.is-visible{
      opacity: 1;
      transform: translateY(0) scale(1);
      transition-delay: var(--d, 0ms);
    }

    /* Links in dark */
    a{
      color: rgba(147,197,253,0.95);
    }
    a:hover{
      color: rgba(191,219,254,1);
    }

    @media (prefers-reduced-motion: reduce){
      .reveal, .card, body::before{
        animation: none !important;
        transition: none !important;
        transform: none !important;
      }
    }
  </style>
</head>

<body>

<div class="container py-5">

  <!-- Messages -->
  {% if messages %}
    <div class="mb-4">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Title / Hero -->
  <div class="text-center mb-5 hero reveal">
    <h1 class="fw-bold mb-2">
      <i class="bi bi-mortarboard-fill me-2"></i>Offres de stage disponibles
    </h1>

    <p class="mb-0">
      Ù„Ù‚ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„ÙŠÙƒ Ø¨Ø³Ø±Ø¹Ø©: Ø´ÙˆÙ Ø§Ù„Ø´Ø±ÙƒØ©ØŒ Ø§Ù„Ù…Ø¯Ø©ØŒ Ø§Ù„ÙƒÙˆÙ†ØªØ§ÙƒØªâ€¦
      ÙˆÙ…Ù† Ø¨Ø¹Ø¯ ÙƒÙ„ÙŠÙƒ Ø¹Ù„Ù‰ <strong>Postuler</strong>.
    </p>

    <div class="hero-note">
      <span class="note-pill"><i class="bi bi-eye-fill"></i> Ù‚Ø±Ø§Ø¡Ø© Ø³Ù‡Ù„Ø© Ù…Ù† Ø§Ù„Ù†Ø¸Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</span>
      <span class="note-pill"><i class="bi bi-mouse-fill"></i> Scroll: Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙƒÙŠØ¨Ø§Ù†Ùˆ ÙˆØ§Ø­Ø¯ Ø¨ÙˆØ§Ø­Ø¯</span>
      <span class="note-pill"><i class="bi bi-stars"></i> Design dark premium</span>
    </div>
  </div>

  {% if offres %}
    <div class="row g-4">
      {% for offre in offres %}
        <div class="col-md-6 col-lg-4 reveal">
          <div class="card h-100">
            <div class="card-body d-flex flex-column p-4">

              <!-- Title -->
              <h5 class="card-title fw-bold mb-2">
                <i class="bi bi-briefcase-fill me-2 text-info"></i>{{ offre.titre }}
              </h5>

              <!-- Company + sector -->
              <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                <span class="badge-sector">
                  <i class="bi bi-building me-1"></i>{{ offre.entreprise.nom }}
                </span>

                {% if offre.entreprise.secteur %}
                  <span class="badge-sector">
                    <i class="bi bi-tags-fill me-1"></i>{{ offre.entreprise.secteur }}
                  </span>
                {% endif %}
              </div>

              <!-- Period badge (fast scanning) -->
              <div class="mb-3">
                <span class="badge-period">
                  <i class="bi bi-calendar-range me-1"></i>
                  {{ offre.date_debut }} â†’ {{ offre.date_fin }}
                </span>
              </div>

              <!-- Description (readable) -->
              <p class="subtle mb-3" style="line-height:1.5;">
                {{ offre.description|truncatechars:140 }}
              </p>

              <!-- Info Grid for instant readability -->
              <div class="info-grid mb-3">

                {% if offre.entreprise.email %}
                  <div class="info-row">
                    <div class="info-ico"><i class="bi bi-envelope-fill"></i></div>
                    <div>
                      <div class="info-k">Email</div>
                      <div class="info-v">{{ offre.entreprise.email }}</div>
                    </div>
                  </div>
                {% endif %}

                {% if offre.entreprise.telephone %}
                  <div class="info-row">
                    <div class="info-ico"><i class="bi bi-telephone-fill"></i></div>
                    <div>
                      <div class="info-k">TÃ©lÃ©phone</div>
                      <div class="info-v">{{ offre.entreprise.telephone }}</div>
                    </div>
                  </div>
                {% endif %}

                {% if offre.entreprise.site_web %}
                  <div class="info-row">
                    <div class="info-ico"><i class="bi bi-globe2"></i></div>
                    <div>
                      <div class="info-k">Site web</div>
                      <div class="info-v">
                        <a href="{{ offre.entreprise.site_web }}" target="_blank" class="text-decoration-none">
                          Visiter le site <i class="bi bi-box-arrow-up-right ms-1"></i>
                        </a>
                      </div>
                    </div>
                  </div>
                {% endif %}

              </div>

              <!-- Button -->
              <div class="mt-auto">
                <a class="btn btn-primary w-100"
                   href="{% url 'stages:postuler' offre.id %}">
                  ğŸš€ Postuler
                </a>
              </div>

            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info text-center reveal">
      Ù…Ø§ ÙƒØ§ÙŠÙ†Ø§Ø´ Ø¹Ø±ÙˆØ¶ Ø¯Ø§Ø¨Ø§.
    </div>
  {% endif %}

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Reveal on scroll + small tilt -->
<script>
  // 1) Reveal on scroll
  (function () {
    const els = document.querySelectorAll(".reveal");
    const obs = new IntersectionObserver((entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting) {
          e.target.classList.add("is-visible");
          obs.unobserve(e.target);
        }
      });
    }, { threshold: 0.12, rootMargin: "0px 0px -6% 0px" });

    els.forEach((el, i) => {
      el.style.setProperty("--d", (i % 12) * 70 + "ms");
      obs.observe(el);
    });
  })();

  // 2) Tiny tilt on cards (desktop only)
  (function () {
    const cards = document.querySelectorAll(".card");
    const isTouch = matchMedia("(pointer: coarse)").matches;
    if (isTouch) return;

    cards.forEach((card) => {
      card.addEventListener("mousemove", (e) => {
        const r = card.getBoundingClientRect();
        const x = e.clientX - r.left;
        const y = e.clientY - r.top;
        const rx = ((y / r.height) - 0.5) * -5;
        const ry = ((x / r.width) - 0.5) *  7;
        card.style.transform = `translateY(-8px) rotateX(${rx}deg) rotateY(${ry}deg)`;
      });
      card.addEventListener("mouseleave", () => {
        card.style.transform = "";
      });
    });
  })();
</script>

</body>
</html>
